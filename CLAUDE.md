# CLAUDE.md

このファイルは、Claude Code（claude.ai/code）がこのリポジトリでコードを操作する際のガイダンスを提供します。

## プロジェクト概要

このリポジトリは「合気道龍」を本部とする、龍全国合気道連盟に所属する「光龍館」の包括的な合気道審査データベースを含む、審査補助アプリのリポジトリです。このプロジェクトでは構造化された審査要件と技術仕様を含みます。

## データ構造

メインデータファイルは`data/aikido-ryu-exam-db.json`にあり、以下を含んでいます：

### 主要セクション

- **metadata**：道場情報（名前、年度、流派、所在地）
- **技術データベース**：2つの主要サブセクションを含む：
  - **基本動作**：基本的な技術と動作
  - **技法**：合気道技術の完全なカタログ
- **審査区分**：階級と年齢グループ別の構造化された審査要件
- **検索インデックス**：効率的なデータ取得のための整理されたインデックス

### データスキーマ

各技術エントリには以下が含まれます：

- `id`：一意識別子（例："basic_001"、"waza_001"）
- `名前`：技術の日本語名
- `よみがな`：ひらがなでの読み方
- `カテゴリ`：分類
- `説明`：説明
- `攻撃`：攻撃タイプ（技法用）
- `形式`：形のバリエーション（「一」または「二」）

### 審査構造

データベースには以下の詳細な審査要件が含まれています：

- **幼年審査**：4-6歳
- **少年審査**：9-10級から初段まで
- **一般初級審査**：一般初心者審査
- **昇級審査**：級位昇格審査
- **昇段審査**：段位審査

## データ操作

### 一般的な操作

- **データ検証**：JSON構造と参照整合性の確認
- **検索操作**：検索インデックスを使用して攻撃タイプ、技術カテゴリ、または形式で技術を検索
- **審査分析**：技術IDと審査要件のクロスリファレンス
- **データ抽出**：異なる審査レベルの特定サブセットを抽出

### データ整合性注意事項

- 審査でのすべての技術参照はIDシステムを使用
- 基本動作は"basic_XXX"IDを使用
- 技法は"waza_XXX"IDを使用
- 一部の審査要件は範囲を参照（例："waza_001-waza_002"）

## ファイル構成

```
aikido-exam-app/
├── index.html                    # メインのWebアプリケーション
├── styles.css                    # アプリケーションのスタイルシート
├── app.js                        # JavaScript アプリケーションロジック
├── data/
│   └── aikido-ryu-exam-db.json   # 完全な審査データベース
└── CLAUDE.md                     # このファイル
```

## アプリケーション機能

### 主要機能

#### 技検索機能
- **キーワード検索**：技名、読み方、説明での検索
- **チェックボックスフィルター**：カテゴリ、攻撃種類、立ち座りでの複数選択フィルタリング
- **リアルタイム検索**：チェックボックス変更時の自動検索
- **音声読み上げ**：検索結果の技カードクリックで音声再生

#### 審査支援機能
- **審査区分選択**：幼年、少年、一般初級、昇級、昇段審査から選択
- **級・段選択**：選択した審査区分に応じた級・段の選択
- **技リスト表示**：選択した級・段の全審査科目を表示
- **ランダム選択**：審査科目からランダムに技を選出
- **音声読み上げ**：Web Speech API を使用した日本語音声読み上げ

#### 管理者機能（Auth0認証必須）
- **技術データ管理**：技の追加、編集、削除
- **タグ管理**：カテゴリタグの追加、削除、使用状況確認
- **データエクスポート**：完全データベース、技データのみ、バックアップファイルの作成
- **データインポート**：JSONファイルからのデータ復元

### 技術仕様

- **フロントエンド**：HTML5、CSS3、Vanilla JavaScript
- **音声合成**：Web Speech API（SpeechSynthesis）
- **データフォーマット**：JSON
- **レスポンシブデザイン**：モバイル・タブレット・デスクトップ対応

### 使用方法

#### 技検索モード
1. Webブラウザで `index.html` を開く
2. 「技検索」タブを選択
3. キーワード検索またはチェックボックスでフィルタリング
4. 検索結果の技カードをクリックで音声読み上げ

#### 審査支援モード
1. 「審査支援」タブを選択
2. 審査区分を選択（幼年審査、少年審査など）
3. 該当する級・段を選択
4. 「全科目表示」で全技を表示、または「ランダム選択」で個別技を選出
5. 技カードまたはランダム選択された技の音声読み上げが自動実行

#### 管理者モード
1. 「管理者ログイン」をクリックしてAuth0認証
2. 認証後、「管理」タブが表示される
3. 技管理：技の追加・編集・削除
4. タグ管理：カテゴリタグの管理
5. データエクスポート：データのバックアップとエクスポート

### 開発・カスタマイズ

#### Auth0認証の設定

管理者機能を使用するには、Auth0の設定が必要です：

1. [Auth0ダッシュボード](https://manage.auth0.com/) でアカウント作成
2. Single Page Application を作成
3. `app.js` のAuth0設定を実際の値に変更
4. Allowed Callback URLs と Allowed Logout URLs にドメインを追加

```javascript
// app.js 17-23行目
this.auth0Config = {
    domain: 'あなたのAuth0ドメイン', // 例: 'dev-example.us.auth0.com'
    clientId: 'あなたのAuth0 Client ID',
    authorizationParams: {
        redirect_uri: window.location.origin
    }
};
```

#### データ構造の変更

- `data/aikido-ryu-exam-db.json` を直接編集
- 新しい技の追加：技術データベースセクションに追加
- 審査要件の変更：審査区分セクションで科目IDリストを更新

#### UI カスタマイズ

- `styles.css`：ビジュアルデザインとレイアウト
- `index.html`：HTML構造とテキスト内容
- `app.js`：動作ロジックと音声設定

#### 音声設定

- 読み上げ速度：`rate` プロパティ（現在：0.8）
- 音程：`pitch` プロパティ（現在：1.0）
- 音量：`volume` プロパティ（現在：1.0）

## 開発メモ

このプロジェクトは純粋なWebアプリケーションで、サーバーサイドの処理は不要です。ローカルファイルシステムからJSON データを読み込むため、Webサーバー経由での実行を推奨します（`file://` プロトコルではCORSエラーが発生する可能性があります）。

### 推奨実行方法

```bash
# Python を使用した簡単なWebサーバー
python -m http.server 8000

# Node.js を使用
npx serve .

# VS Code Live Server 拡張機能を使用
```